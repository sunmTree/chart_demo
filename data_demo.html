<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script>
    /**
     * 消息会话时间显示
     */
    const timeFormat = (date) => {
        if (!date) return ''
        let newtime
        let nowtime = new Date()
        // if (date.constructor !== Date) {
        //     date = new Date(date.replace(/\-/g, '/')) // 解决ios日期显示NAN问题
        // }
        date = new Date(date)
        // 获取消息发送时间
        let Y = date.getFullYear()
        let M = date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1
        let D = date.getDate() < 10 ? '0' + date.getDate() : date.getDate()
        let W = date.getDay()
        let H = date.getHours() < 10 ? '0' + date.getHours() : date.getHours()
        let Min = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes()
        // 获取当前时间
        let nowY = nowtime.getFullYear()
        let nowM = nowtime.getMonth() + 1 < 10 ? '0' + (nowtime.getMonth() + 1) : nowtime.getMonth() + 1
        let nowD = nowtime.getDate() < 10 ? '0' + nowtime.getDate() : nowtime.getDate()
        let isWeek = Math.abs(date - nowtime) < 7 * 24 * 3600 * 1000
        if (Y < nowY) {
            // 去年
            newtime = Y + '-' + M + '-' + D
        } else {
            if (Y === nowY && M === nowM && (nowD - D <= 7)) {
                // 昨天
                if ((nowD - D) === 1) {
                    newtime = '昨天'
                } else if (nowD === D) {
                    // 当天
                    newtime = H + ':' + Min
                } else {
                    // 一周内
                    newtime = weekFormat(W)
                }
            }
            else {
                // 一年内
                newtime = M + '-' + D
            }
        }
        return newtime
    }
    // 星期
    const weekFormat = (num) => {
        let str
        switch (num) {
            case 1:
                str = '星期一'
                break
            case 2:
                str = '星期二'
                break
            case 3:
                str = '星期三'
                break
            case 4:
                str = '星期四'
                break
            case 5:
                str = '星期五'
                break
            case 6:
                str = '星期六'
                break
            default:
                str = '星期天'
        }
        return str
    }

    const oldTime = new Date("2019/7/16 20:11:11");
    const oldTime2 = new Date("2019/7/14 20:11:11");
    let date = new Date().getTime();
    let interval = new Date(date - oldTime)
    console.log(oldTime + " interval " + interval)
    console.log(timeFormat(oldTime) + "")
    console.log(timeFormat(oldTime) + " " + oldTime.getHours() + ":" + oldTime.getMinutes())
    console.log(timeFormat(oldTime2))

    let funtion = new Function()

</script>
<body>

</body>
</html>